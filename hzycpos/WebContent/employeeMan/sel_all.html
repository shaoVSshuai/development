<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>全部员工查询</title>
<script type="text/javascript" src="/hzycpos/js/jquery-3.2.0.min.js"></script>
<script type="text/javascript" src="/hzycpos/js/jquery-validate/lib/jquery.js"></script>

<!-- <script type="text/javascript" src="/hzycpos/js/jquery-validate/dist/jquery.validate.min.js"></script>
<script src="/hzycpos/js/jquery-validate/dist/localization/messages_zh.js"></script> -->
<link rel="stylesheet" href="/hzycpos/plugin/layui/css/layui.css">
<script src="/hzycpos/plugin/layui/layui.js"></script>
<script>
	$(function(){
		
			
		
		var curWwwPath = window.document.location.href;
		var pathName = window.document.location.pathname;
        //获取带"/"的项目名，如：/uimcardprj
        var pos = curWwwPath.indexOf(pathName);
         var localhostPath = curWwwPath.substring(0, pos);
        var projectName = pathName.substring(0, pathName.substr(1).indexOf('/') + 1);
        var basePath = localhostPath + projectName + "/";
		$.ajax({
				url: basePath+'user/selective.action',
				type: 'post',
				dataType: 'json',
				data: {
				},
				success: function(res){
					var tr = "";
					var obj = res.userList;
					for(var i = 0 ; i < obj.length ; i++){
						tr += '<tr>'+
						'<td>'+ obj[i].id +'</td>'+
						'<td>'+ obj[i].uname +'</td>'+
						'<td>'+ obj[i].phone +'</td>'+
						'<td>'+ obj[i].trueName +'</td>'+
						'<td>'+ obj[i].idcard +'</td>'+
						'<td>'+ obj[i].rname +'</td>'+
						'<td>'+ obj[i].storeName +'</td>'+
						'<td> <button class="layui-btn layui-btn-sm layui-btn-normal">详细</button>'+
							'<button class="layui-btn layui-btn-sm layui-btn-normal">修改</button>'+
							'<button class="layui-btn layui-btn-sm layui-btn-normal">删除</button>'+
						'</td>'+
						'</tr>';
					}
					$(".layui-table").find("tbody").append(tr);
				},
				error: function(res){
					alert("请求失败");
				}
		});
	});
</script>
</head>
<body>
 <script>
		//请注意 不是我要在页面直接加载这段函数  而是因为ui渲染后无法追加了
		var curWwwPath = window.document.location.href;
		var pathName = window.document.location.pathname;
	    //获取带"/"的项目名，如：/uimcardprj
	    var pos = curWwwPath.indexOf(pathName);
	     var localhostPath = curWwwPath.substring(0, pos);
	    var projectName = pathName.substring(0, pathName.substr(1).indexOf('/') + 1);
	    var basePath = localhostPath + projectName + "/";
		$.ajax({
			url: basePath+'storeInfo/selAll.action',
			type: 'post',
			dataType: 'json',
			data: {
			},
			success: function(res){
				alert(res);
				var obj = res.list;
				//获取下拉狂
				
				for(var i = 0 ; i < obj.length ; i ++){
					 var allOption = '<option value="'+obj[i].id+'" >'+ obj[i].name +'</option>';
					$("#storeInfoId").append(allOption);
				}
			},
			error: function(res){
			}
		});
		$.ajax({
			url: basePath+'role/selAll.action',
			type: 'post',
			dataType: 'json',
			data: {
			},
			success: function(res){
				var obj = res.list;
				//获取下拉狂
				
				for(var i = 0 ; i < obj.length ; i ++){
					 var allOption = '<option value="'+obj[i].id+'" >'+ obj[i].rname +'</option>';
					$("#rid").append(allOption);
				}
			},
			error: function(res){
			}
		})
</script>
 <div id="topper">
 	<form class="layui-form">
 		<div class="layui-form-item">
    		<label class="layui-form-label"><span class="red">*</span>用户名：</label> 
   			<div class="layui-input-inline">
     			<input class="layui-input mywidth" type="text" name="user.uname" id="username" required lay-verify="required" /> 
   			</div>
   			<label class="layui-form-label"><span class="red">*</span>身份证号：</label> 
   			<div class="layui-input-inline">
   				 <input class="layui-input mywidth" type="text" name="user.uname" id="username" required lay-verify="required" /> 
			</div>
			<label class="layui-form-label"><span class="red">*</span>所属店铺：</label> 
   			<div class="layui-input-inline">
     			<select class="mywidth" id="storeInfoId" name="user.storeInfoId" >
     				
     			</select>
   			</div>
   			<label class="layui-form-label"><span class="red">*</span>职位/角色：</label> 
   			<div class="layui-input-inline">
     			<select class="mywidth" id="rid" name="user.rid" >
     			</select>
   			</div>
 		</div>
 		
 	</form>
 
 </div>
 <table class="layui-table" lay-even="" lay-skin="row">
  <colgroup>
    <col width="150">
    <col width="150">
    <col width="200">
    <col>
  </colgroup>
  <thead>
    <tr>
      <th>用户ID</th>
      <th>用户名</th>
      <th>电话</th>
      <th>真实姓名</th>
      <th>身份证号</th>
      <th>职位/角色</th>
      <th>所属店铺</th>
      <th>操作</th>
    </tr> 
  </thead>
  <tbody>
  </tbody>
</table> 
	<script>
//一般直接写在一个js文件中
layui.use(['layer', 'form'], function(){
  var layer = layui.layer
  ,form = layui.form;
  
  if(window.location.href.indexOf("?") != -1){
	  var url = window.location.href;
	  var kv = url.substring(url.indexOf("?"));
	  var array = kv.split("=");
	  if(array[1] == 102){
		  layer.msg('操作成功');
	  }else{
		  layui.msg('操作失败,未知错误');
	  }
  }
});
</script>
</body>
</html>